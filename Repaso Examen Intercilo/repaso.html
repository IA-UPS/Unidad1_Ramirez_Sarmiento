<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Edmond Géraud">

<title>Predicción de la diabetes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="repaso_files/libs/clipboard/clipboard.min.js"></script>
<script src="repaso_files/libs/quarto-html/quarto.js"></script>
<script src="repaso_files/libs/quarto-html/popper.min.js"></script>
<script src="repaso_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="repaso_files/libs/quarto-html/anchor.min.js"></script>
<link href="repaso_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="repaso_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="repaso_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="repaso_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="repaso_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Predicción de la diabetes</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Edmond Géraud </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="intro" class="level1">
<h1>Intro</h1>
<p>Este sería un ejemplo de examen El siguiente conjunto de datos, consuste en predecir a pacientes basandonos en datos clínicos, si puede padecer diabetes o no.</p>
<p>Antes de cualquier método de clasificación, regresión o lo que sea, necesitamos explorar los datos.</p>
<p>Esto supone exámenes estadísticos inferenciales univariantes, bivariantes y multivariantes.</p>
</section>
<section id="pima-indians-diabetes-database" class="level1">
<h1>Pima Indians Diabetes Database</h1>
<p>This dataset is originally from the National Institute of Diabetes and Digestive and Kidney Diseases. The objective of the dataset is to diagnostically predict whether or not a patient has diabetes, based on certain diagnostic measurements included in the dataset. Several constraints were placed on the selection of these instances from a larger database. In particular, all patients here are females at least 21 years old of Pima Indian heritage.</p>
</section>
<section id="cargamos-librerias" class="level1">
<h1>Cargamos librerias</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggstatsplot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>You can cite this package as:
     Patil, I. (2021). Visualizations with statistical details: The 'ggstatsplot' approach.
     Journal of Open Source Software, 6(61), 3167, doi:10.21105/joss.03167</code></pre>
</div>
</div>
</section>
<section id="cargamos-los-datos" class="level1">
<h1>Cargamos los datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>) <span class="do">###El comando nos permite leer los datos, para esot debemos poner la ruta especifica</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies Glucose BloodPressure SkinThickness Insulin  BMI
1           6     148            72            35       0 33.6
2           1      85            66            29       0 26.6
3           8     183            64             0       0 23.3
4           1      89            66            23      94 28.1
5           0     137            40            35     168 43.1
6           5     116            74             0       0 25.6
  DiabetesPedigreeFunction Age Outcome
1                    0.627  50       1
2                    0.351  31       0
3                    0.672  32       1
4                    0.167  21       0
5                    2.288  33       1
6                    0.201  30       0</code></pre>
</div>
</div>
<p>Si echamos una búsqueda rápida en google, observamos que el pedigree, es eso, la historia familiar de diabetes. Por lo tanto, aquí podríamso hacer varias cosas ! Entre ellas, regresar los datos a dicha función, o clasificar según esta variable, considerarla o no considerarla.</p>
<p>Para empezar vamos a considerarla para ver la clasificación del modelo knn y bayes.</p>
<section id="miramos-las-clases-de-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="miramos-las-clases-de-los-datos">Miramos las clases de los datos</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(datos) <span class="do">###Nos permite ver los datos que cargamos</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   768 obs. of  9 variables:
 $ Pregnancies             : int  6 1 8 1 0 5 3 10 2 8 ...
 $ Glucose                 : int  148 85 183 89 137 116 78 115 197 125 ...
 $ BloodPressure           : int  72 66 64 66 40 74 50 0 70 96 ...
 $ SkinThickness           : int  35 29 0 23 35 0 32 0 45 0 ...
 $ Insulin                 : int  0 0 0 94 168 0 88 0 543 0 ...
 $ BMI                     : num  33.6 26.6 23.3 28.1 43.1 25.6 31 35.3 30.5 0 ...
 $ DiabetesPedigreeFunction: num  0.627 0.351 0.672 0.167 2.288 ...
 $ Age                     : int  50 31 32 21 33 30 26 29 53 54 ...
 $ Outcome                 : int  1 0 1 0 1 0 1 0 1 1 ...</code></pre>
</div>
</div>
<p>La única variable que debemos de cambiar es <code>Outcome</code> a factor. Donde 1 es diebetes, y 0 es no diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome  <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome) <span class="do">### Convertimos la columna outcome en un data frame</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="análisis-estadístico-preliminar" class="level1">
<h1>Análisis estadístico preliminar</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(datos) <span class="do">### Nos permite ver las dimenciones de los datos, es decir las filas y columnas</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 768   9</code></pre>
</div>
</div>
<p>Tenemos 768 filas y 9 columnas. Analicemos primero dos a dos las variables una por una</p>
<section id="histogramas" class="level3">
<h3 class="anchored" data-anchor-id="histogramas">Histogramas</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>) <span class="do">###Creamos un vector </span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span> <span class="do">### Restamos una columna</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>} <span class="do">### Recorre las columnas de un objeto de datos y crea un histograma para cada columna</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">### Los gráficos resultantes se almacenan en una lista llamada "l.plots", donde cada elemento de la lista contiene el gráfico correspondiente a una columna específica del objeto de datos.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>l.plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-7-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>En lo particular la variable del pedigree se me hace importante, entonces vamos a realizar gráficos de dispersión</p>
<p>En realidad, una buena práctica es correlacionar todas contra todas…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,BMI,DiabetesPedigreeFunction) <span class="do">### Creamos un grafico de disperción</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Registered S3 method overwritten by 'ggside':
  method from   
  +.gg   ggplot2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Sin embargo, esto puede ser un proceso tedioso… imaginad hacer 16 gráficas ! podemos condersarlo todo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]) <span class="do">### Se hace un analisis de correlación</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p <span class="do">### Se extraen valores</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj <span class="do">### SE reemplazan los valores por encima de la diagonal por valores preajustados</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj <span class="do">### SE reemplazan los valores por debajo de la diagonal por valores preajustados</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>) <span class="do">### Crea un gráfico de correlación</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora podemos proceder a hacer algo similar, con una serie de comparaciones dos a dos sobre las medias o medianas, sobre cada variable y la variable de interés.</p>
<p>Primero debemos aplicar una regresión linear con variable dependiente cada variable numérica y por la categórica. Es decir un t.test pero con el fin de ver los residuos, para ver la normalidad de éstos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals),</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>p.norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9389, p-value &lt; 2.2e-16


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97511, p-value = 3.726e-10


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.81468, p-value &lt; 2.2e-16


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.92004, p-value &lt; 2.2e-16


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.77776, p-value &lt; 2.2e-16


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.94359, p-value &lt; 2.2e-16


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.84939, p-value &lt; 2.2e-16


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.88114, p-value &lt; 2.2e-16</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Este codigo se utiliza para realizar pruebas de normalidad en los residuos de los modelos de regresión lineal entre cada columna de un conjunto de datos y una variable de resultado</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Todas las variables son no normales, tal como vemos en los histogramas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Pregnancies,<span class="at">type =</span> <span class="st">"nonparametric"</span>) <span class="do">### para realizar pruebas estadísticas entre grupos definidos por una variable categórica y una variable numérica</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Glucose,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BloodPressure,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Insulin,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,BMI,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,DiabetesPedigreeFunction,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggbetweenstats</span>(datos,Outcome,Age,<span class="at">type =</span> <span class="st">"nonparametric"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="pca" class="level3">
<h3 class="anchored" data-anchor-id="pca">PCA</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">### Se utiliza para realizar un análisis de componentes principales (PCA, por sus siglas en inglés) y visualizar los resultados en un gráfico de dispersión</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Ahora vamos a ver si haciendo unas transformaciones esto cambia. Pero antes debemos de ver las variables sospechosas…</p>
<p>Pero de igual manera podemos escalar a ver si hay algun cambio…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :  0.0   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:  0.0   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 30.5   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 79.8   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.:127.2   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   :846.0   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>factoextra<span class="sc">::</span><span class="fu">fviz_contrib</span>(pcx,<span class="st">"var"</span>) <span class="do">###sirve para vsualizar las contribuciones de las variables a los componentes principales obtenidos mediante el PCA</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Al parecer es la insulina la que está dando problemas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="do">## indices a quitar</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>w <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">grep</span>(<span class="st">"insulin"</span>,<span class="at">ignore.case =</span> T,<span class="fu">colnames</span>(datos)),<span class="fu">ncol</span>(datos))</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="sc">-</span>w],<span class="at">scale. =</span> F) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>De hecho la insulina, tenía un aspecto raro, como sesgado, ver gráficos de arriba. Vamos a transformala…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin<span class="fl">+0.05</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies        Glucose      BloodPressure    SkinThickness  
 Min.   : 0.000   Min.   :  0.0   Min.   :  0.00   Min.   : 0.00  
 1st Qu.: 1.000   1st Qu.: 99.0   1st Qu.: 62.00   1st Qu.: 0.00  
 Median : 3.000   Median :117.0   Median : 72.00   Median :23.00  
 Mean   : 3.845   Mean   :120.9   Mean   : 69.11   Mean   :20.54  
 3rd Qu.: 6.000   3rd Qu.:140.2   3rd Qu.: 80.00   3rd Qu.:32.00  
 Max.   :17.000   Max.   :199.0   Max.   :122.00   Max.   :99.00  
    Insulin            BMI        DiabetesPedigreeFunction      Age       
 Min.   :-2.996   Min.   : 0.00   Min.   :0.0780           Min.   :21.00  
 1st Qu.:-2.996   1st Qu.:27.30   1st Qu.:0.2437           1st Qu.:24.00  
 Median : 3.418   Median :32.00   Median :0.3725           Median :29.00  
 Mean   : 1.008   Mean   :31.99   Mean   :0.4719           Mean   :33.24  
 3rd Qu.: 4.847   3rd Qu.:36.60   3rd Qu.:0.6262           3rd Qu.:41.00  
 Max.   : 6.741   Max.   :67.10   Max.   :2.4200           Max.   :81.00  
 Outcome
 0:500  
 1:268  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Cambia ! Esto significa que no hemos quitado la infromacion de la insulina, solamente lo hemos transformado</p>
<p>Es decir, cambia si transformamos los datos…a partir de esto, podemos realizar de nuevo pruebas de diferencia de medianas, pero ahora lo veremos condensado..</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>datsc <span class="ot">&lt;-</span> <span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Veamos las distribuciones de nuevo….</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>l.plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-24-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso, los valores la insulina, han cambiado por la transformación en valor mas no la distribución, vamos a hacer unos arrelgos…</p>
<p>Al parecer la preñanza esta ligada a una esgala logaritmica de 2 Esto es otra cosa…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>)</span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(Pregnancies))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>Pregnancies,<span class="at">plot=</span>F)<span class="sc">$</span>breaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Realizaremos lo mismo con la grosura de la piel</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness  <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>SkinThickness<span class="fl">+0.5</span>)</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(datos,<span class="fu">aes</span>(SkinThickness))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">hist</span>(datos<span class="sc">$</span>SkinThickness,<span class="at">plot=</span>F)<span class="sc">$</span>breaks)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tenemos algo raro, lo más posible sea por la obesidad…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggscatterstats</span>(datos,SkinThickness,BMI)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.
`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Curioso ! al parecer los datos tienen valores nulos, los cuales solo están en las otras variables que no sean pregnancies. Vamos a quitarlos…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x))</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="vamos-a-quitar-estos-valores" class="level3">
<h3 class="anchored" data-anchor-id="vamos-a-quitar-estos-valores">vamos a quitar estos valores</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Se redujo el data set a 392 observaciones…</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(datos<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
  0   1 
262 130 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>l.plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-31-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora si podemos realizar las transfomraciones</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)] <span class="ot">&lt;-</span> <span class="fu">apply</span>(datos[,<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">9</span>)],<span class="dv">2</span>,<span class="cf">function</span>(x) <span class="fu">ifelse</span>(x<span class="sc">==</span><span class="dv">0</span>,<span class="cn">NA</span>,x))</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> datos[<span class="fu">complete.cases</span>(datos),]</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Insulin <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Insulin)</span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Pregnancies <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Pregnancies<span class="fl">+0.5</span>)</span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>DiabetesPedigreeFunction <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>DiabetesPedigreeFunction)</span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>SkinThickness <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((datos<span class="sc">$</span>SkinThickness))</span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Glucose <span class="ot">&lt;-</span> <span class="fu">log</span>(datos<span class="sc">$</span>Glucose)</span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Age <span class="ot">&lt;-</span><span class="fu">log2</span>(datos<span class="sc">$</span>Age)</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>l.plots <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>,<span class="at">length =</span> <span class="fu">ncol</span>(datos)<span class="sc">-</span><span class="dv">1</span>)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">ncol</span>(datos) <span class="sc">-</span><span class="dv">1</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n1){</span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a>  h <span class="ot">&lt;-</span><span class="fu">hist</span>(datos[,j],<span class="at">plot =</span> F)</span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a>  datos.tmp <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">value=</span>datos[,j],<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(datos.tmp,<span class="fu">aes</span>(value,<span class="at">fill=</span>outcome))<span class="sc">+</span><span class="fu">geom_histogram</span>(<span class="at">breaks=</span>h<span class="sc">$</span>breaks) <span class="sc">+</span> <span class="fu">ggtitle</span>(<span class="fu">paste</span>(<span class="st">"Histogram of"</span>, <span class="fu">colnames</span>(datos)[j]))</span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a>  l.plots[[j]] <span class="ot">&lt;-</span> p1</span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a>l.plots</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[2]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[3]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[4]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[5]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[6]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[7]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-7.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
[[8]]</code></pre>
</div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-32-8.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Con las anteriores transformaciones vamos a realizar el PCA de nuevo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(datos)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Pregnancies         Glucose      BloodPressure    SkinThickness  
 Min.   :-0.6931   Min.   :4.025   Min.   : 24.00   Min.   :2.646  
 1st Qu.: 0.4055   1st Qu.:4.595   1st Qu.: 62.00   1st Qu.:4.583  
 Median : 0.9163   Median :4.779   Median : 70.00   Median :5.385  
 Mean   : 0.9590   Mean   :4.778   Mean   : 70.66   Mean   :5.305  
 3rd Qu.: 1.7047   3rd Qu.:4.963   3rd Qu.: 78.00   3rd Qu.:6.083  
 Max.   : 2.8622   Max.   :5.288   Max.   :110.00   Max.   :7.937  
    Insulin           BMI        DiabetesPedigreeFunction      Age       
 Min.   :2.639   Min.   :18.20   Min.   :-2.4651          Min.   :4.392  
 1st Qu.:4.341   1st Qu.:28.40   1st Qu.:-1.3103          1st Qu.:4.524  
 Median :4.832   Median :33.20   Median :-0.7996          Median :4.755  
 Mean   :4.813   Mean   :33.09   Mean   :-0.8391          Mean   :4.882  
 3rd Qu.:5.247   3rd Qu.:37.10   3rd Qu.:-0.3754          3rd Qu.:5.170  
 Max.   :6.741   Max.   :67.10   Max.   : 0.8838          Max.   :6.340  
 Outcome
 0:262  
 1:130  
        
        
        
        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>pcx <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1],<span class="at">scale. =</span> T) <span class="do">## escalamos por la variablidad de los datos</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>plotpca <span class="ot">&lt;-</span> <span class="fu">bind_cols</span>(pcx<span class="sc">$</span>x,<span class="at">outcome=</span>datos<span class="sc">$</span>Outcome)</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(plotpca,<span class="fu">aes</span>(PC1,PC2,<span class="at">color=</span>outcome))<span class="sc">+</span><span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Ahora vamos a realizar las pruebas de medianas</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]),</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">summary</span>(<span class="fu">lm</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome))<span class="sc">$</span>residuals),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">2</span>,</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>      shapiro.test)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>p.norm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$Pregnancies

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.95146, p-value = 4.684e-10


$Glucose

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.9958, p-value = 0.3813


$BloodPressure

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99011, p-value = 0.009686


$SkinThickness

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99384, p-value = 0.1123


$Insulin

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99054, p-value = 0.0128


$BMI

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.97122, p-value = 5.374e-07


$DiabetesPedigreeFunction

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.99456, p-value = 0.1796


$Age

    Shapiro-Wilk normality test

data:  newX[, i]
W = 0.93053, p-value = 1.561e-12</code></pre>
</div>
</div>
<p>Hemos conseguido la normalidad en solo dos variables, si fueran mas procederiamos con t test pero como no es asi, con test de Wilcoxon</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>p.norm <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">scale</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1]),</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>            <span class="dv">2</span>,</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>            <span class="cf">function</span>(x) <span class="fu">wilcox.test</span>(x<span class="sc">~</span>datos<span class="sc">$</span>Outcome)<span class="sc">$</span>p.value)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Observamos que en una primera instancia ahora todas tienen diferencias significativas, esto tenemos que corregir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>p.adj <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p.norm,<span class="st">"BH"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Todas siguen siendo significativas, ahora vamos a ver cuales aumentan o disminyuen respecto las otras</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>datos.split <span class="ot">&lt;-</span> <span class="fu">split</span>(datos,datos<span class="sc">$</span>Outcome)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>datos.median <span class="ot">&lt;-</span> <span class="fu">lapply</span>(datos.split, <span class="cf">function</span>(x) <span class="fu">apply</span>(x[,<span class="sc">-</span><span class="fu">ncol</span>(x)],<span class="dv">2</span>,median))</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-6"><a href="#cb95-6" aria-hidden="true" tabindex="-1"></a>toplot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">medianas=</span><span class="fu">Reduce</span>(<span class="st">"-"</span>,datos.median)</span>
<span id="cb95-7"><a href="#cb95-7" aria-hidden="true" tabindex="-1"></a>,<span class="at">p.values=</span>p.adj)</span>
<span id="cb95-8"><a href="#cb95-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-9"><a href="#cb95-9" aria-hidden="true" tabindex="-1"></a>toplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                           medianas     p.values
Pregnancies              -0.3364722 8.957407e-05
Glucose                  -0.2957935 4.902429e-22
BloodPressure            -4.0000000 8.957407e-05
SkinThickness            -0.5484102 4.309442e-07
Insulin                  -0.4788534 3.241934e-13
BMI                      -3.3500000 2.574728e-07
DiabetesPedigreeFunction -0.2779529 8.957407e-05
Age                      -0.4005379 1.577456e-14</code></pre>
</div>
</div>
<p>Ahora Todos los valores son significativos respecto a la obesidad</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>También podemos observar como cambian las relaciones segun la diabetes</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">0</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>obj.cor <span class="ot">&lt;-</span> psych<span class="sc">::</span><span class="fu">corr.test</span>(datos[datos<span class="sc">$</span>Outcome<span class="sc">==</span><span class="dv">1</span>,<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>p.values <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">upper.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a>p.values[<span class="fu">lower.tri</span>(p.values)] <span class="ot">&lt;-</span> obj.cor<span class="sc">$</span>p.adj</span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">diag</span>(p.values) <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a>corrplot<span class="sc">::</span><span class="fu">corrplot</span>(<span class="at">corr =</span> obj.cor<span class="sc">$</span>r,<span class="at">p.mat =</span> p.values,<span class="at">sig.level =</span> <span class="fl">0.05</span>,<span class="at">insig =</span> <span class="st">"label_sig"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Es decir, existen correlaciones únicas de la obesidad y no obesidad, y existen otras correlaciones que son debidas a otros factores.</p>
</section>
</section>
<section id="particion-de-datos" class="level1">
<h1>Particion de datos</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="#cb100-5" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb100-6"><a href="#cb100-6" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="modelado" class="level1">
<h1>Modelado</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>glm.mod <span class="ot">&lt;-</span> <span class="fu">glm</span>(Outcome <span class="sc">~</span>.,<span class="at">data=</span>dat.train,<span class="at">family =</span> <span class="st">"binomial"</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">ifelse</span>(<span class="fu">predict</span>(glm.mod,dat.test,<span class="at">type=</span><span class="st">"response"</span>)<span class="sc">&gt;=</span><span class="fl">0.5</span>,<span class="st">"N"</span>,<span class="st">"D"</span>))</span>
<span id="cb101-6"><a href="#cb101-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-7"><a href="#cb101-7" aria-hidden="true" tabindex="-1"></a>caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 73 13
         N  9 23
                                          
               Accuracy : 0.8136          
                 95% CI : (0.7314, 0.8793)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.002512        
                                          
                  Kappa : 0.5462          
                                          
 Mcnemar's Test P-Value : 0.522431        
                                          
            Sensitivity : 0.8902          
            Specificity : 0.6389          
         Pos Pred Value : 0.8488          
         Neg Pred Value : 0.7188          
             Prevalence : 0.6949          
         Detection Rate : 0.6186          
   Detection Prevalence : 0.7288          
      Balanced Accuracy : 0.7646          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<p>LASSO</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">0</span>,</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>))</span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T)</span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 78 20
         N  4 16
                                          
               Accuracy : 0.7966          
                 95% CI : (0.7127, 0.8651)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.00892         
                                          
                  Kappa : 0.452           
                                          
 Mcnemar's Test P-Value : 0.00220         
                                          
            Sensitivity : 0.9512          
            Specificity : 0.4444          
         Pos Pred Value : 0.7959          
         Neg Pred Value : 0.8000          
             Prevalence : 0.6949          
         Detection Rate : 0.6610          
   Detection Prevalence : 0.8305          
      Balanced Accuracy : 0.6978          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>tuneGrid<span class="ot">=</span><span class="fu">expand.grid</span>(</span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>              <span class="at">.alpha=</span><span class="dv">1</span>,</span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">.lambda=</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.0001</span>))</span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>trainControl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"repeatedcv"</span>,</span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>                       <span class="at">number =</span> <span class="dv">10</span>,</span>
<span id="cb105-6"><a href="#cb105-6" aria-hidden="true" tabindex="-1"></a>                       <span class="at">repeats =</span> <span class="dv">3</span>,</span>
<span id="cb105-7"><a href="#cb105-7" aria-hidden="true" tabindex="-1"></a>                       <span class="co"># prSummary needs calculated class,</span></span>
<span id="cb105-8"><a href="#cb105-8" aria-hidden="true" tabindex="-1"></a>                       <span class="at">classProbs =</span> T)</span>
<span id="cb105-9"><a href="#cb105-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-10"><a href="#cb105-10" aria-hidden="true" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"glmnet"</span>, <span class="at">trControl =</span> trainControl,<span class="at">tuneGrid=</span>tuneGrid,</span>
<span id="cb105-11"><a href="#cb105-11" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">metric=</span><span class="st">"Accuracy"</span></span>
<span id="cb105-12"><a href="#cb105-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb105-13"><a href="#cb105-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-14"><a href="#cb105-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="fu">predict</span>(model,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)]),dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 73 19
         N  9 17
                                          
               Accuracy : 0.7627          
                 95% CI : (0.6756, 0.8362)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.06445         
                                          
                  Kappa : 0.3931          
                                          
 Mcnemar's Test P-Value : 0.08897         
                                          
            Sensitivity : 0.8902          
            Specificity : 0.4722          
         Pos Pred Value : 0.7935          
         Neg Pred Value : 0.6538          
             Prevalence : 0.6949          
         Detection Rate : 0.6186          
   Detection Prevalence : 0.7797          
      Balanced Accuracy : 0.6812          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>mdl <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> .,<span class="at">data=</span>dat.train,<span class="at">laplace =</span> <span class="dv">0</span>)</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span><span class="fu">predict</span>(mdl,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)])</span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 65 10
         N 17 26
                                          
               Accuracy : 0.7712          
                 95% CI : (0.6848, 0.8435)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.04195         
                                          
                  Kappa : 0.4883          
                                          
 Mcnemar's Test P-Value : 0.24821         
                                          
            Sensitivity : 0.7927          
            Specificity : 0.7222          
         Pos Pred Value : 0.8667          
         Neg Pred Value : 0.6047          
             Prevalence : 0.6949          
         Detection Rate : 0.5508          
   Detection Prevalence : 0.6356          
      Balanced Accuracy : 0.7575          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>lambda_use <span class="ot">&lt;-</span> <span class="fu">min</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda[model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">&gt;=</span> model<span class="sc">$</span>bestTune<span class="sc">$</span>lambda])</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>position <span class="ot">&lt;-</span> <span class="fu">which</span>(model<span class="sc">$</span>finalModel<span class="sc">$</span>lambda <span class="sc">==</span> lambda_use)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>featsele <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="fu">coef</span>(model<span class="sc">$</span>finalModel)[, position])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(featsele)[featsele<span class="sc">$</span>coef.model.finalModel....position.<span class="sc">!=</span><span class="dv">0</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "(Intercept)"              "Glucose"                 
[3] "BMI"                      "DiabetesPedigreeFunction"
[5] "Age"                     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>mdl.sel <span class="ot">&lt;-</span><span class="fu">naiveBayes</span>(Outcome <span class="sc">~</span> Insulin<span class="sc">+</span>Glucose<span class="sc">+</span>DiabetesPedigreeFunction<span class="sc">+</span>Age,<span class="at">data =</span> dat.train)</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(mdl.sel,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)])</span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 67 12
         N 15 24
                                          
               Accuracy : 0.7712          
                 95% CI : (0.6848, 0.8435)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.04195         
                                          
                  Kappa : 0.4727          
                                          
 Mcnemar's Test P-Value : 0.70031         
                                          
            Sensitivity : 0.8171          
            Specificity : 0.6667          
         Pos Pred Value : 0.8481          
         Neg Pred Value : 0.6154          
             Prevalence : 0.6949          
         Detection Rate : 0.5678          
   Detection Prevalence : 0.6695          
      Balanced Accuracy : 0.7419          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">400</span>)</span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>ctrl <span class="ot">&lt;-</span> <span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">repeats =</span> <span class="dv">3</span>) <span class="co">#,classProbs=TRUE,summaryFunction = twoClassSummary)</span></span>
<span id="cb114-5"><a href="#cb114-5" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> <span class="fu">train</span>(Outcome <span class="sc">~</span> ., <span class="at">data =</span> dat.train, <span class="at">method =</span> <span class="st">"knn"</span>, <span class="at">trControl =</span> ctrl, <span class="at">preProcess =</span> <span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="at">tuneLength =</span> <span class="dv">50</span>)</span>
<span id="cb114-6"><a href="#cb114-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-7"><a href="#cb114-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Output of kNN fit</span></span>
<span id="cb114-8"><a href="#cb114-8" aria-hidden="true" tabindex="-1"></a>knnFit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>k-Nearest Neighbors 

274 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 3 times) 
Summary of sample sizes: 246, 246, 247, 246, 246, 247, ... 
Resampling results across tuning parameters:

  k    Accuracy   Kappa    
    5  0.7457231  0.4170221
    7  0.7690476  0.4586112
    9  0.7628307  0.4429766
   11  0.7626543  0.4398062
   13  0.7540564  0.4182983
   15  0.7565256  0.4274335
   17  0.7590829  0.4285909
   19  0.7651235  0.4423979
   21  0.7588183  0.4291143
   23  0.7550705  0.4161501
   25  0.7588624  0.4263421
   27  0.7601852  0.4264316
   29  0.7625220  0.4329862
   31  0.7712081  0.4546471
   33  0.7723545  0.4585199
   35  0.7784832  0.4728895
   37  0.7772487  0.4693976
   39  0.7748236  0.4641469
   41  0.7760582  0.4665216
   43  0.7736332  0.4610975
   45  0.7748677  0.4635753
   47  0.7676367  0.4427781
   49  0.7676367  0.4433362
   51  0.7652557  0.4356954
   53  0.7664903  0.4398030
   55  0.7605379  0.4236620
   57  0.7556437  0.4136591
   59  0.7471340  0.3891121
   61  0.7544533  0.4083644
   63  0.7520723  0.4026207
   65  0.7582011  0.4156867
   67  0.7581129  0.4141207
   69  0.7617284  0.4207677
   71  0.7605379  0.4175171
   73  0.7593474  0.4154945
   75  0.7544533  0.4012084
   77  0.7582011  0.4115809
   79  0.7630511  0.4218938
   81  0.7666226  0.4309091
   83  0.7641093  0.4205083
   85  0.7616843  0.4158178
   87  0.7629189  0.4166985
   89  0.7628748  0.4136418
   91  0.7627425  0.4098230
   93  0.7615961  0.4046240
   95  0.7651235  0.4122212
   97  0.7664462  0.4157248
   99  0.7640653  0.4075856
  101  0.7628307  0.4056474
  103  0.7615961  0.3995614

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was k = 35.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(knnFit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="repaso_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>knnPredict <span class="ot">&lt;-</span> <span class="fu">predict</span>(knnFit,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(dat.test)] )</span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Get the confusion matrix to see accuracy value and other parameter values</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(knnPredict, dat.test<span class="sc">$</span>Outcome )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction  D  N
         D 77 21
         N  5 15
                                          
               Accuracy : 0.7797          
                 95% CI : (0.6941, 0.8507)
    No Information Rate : 0.6949          
    P-Value [Acc &gt; NIR] : 0.026176        
                                          
                  Kappa : 0.4063          
                                          
 Mcnemar's Test P-Value : 0.003264        
                                          
            Sensitivity : 0.9390          
            Specificity : 0.4167          
         Pos Pred Value : 0.7857          
         Neg Pred Value : 0.7500          
             Prevalence : 0.6949          
         Detection Rate : 0.6525          
   Detection Prevalence : 0.8305          
      Balanced Accuracy : 0.6778          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb119-5"><a href="#cb119-5" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb119-6"><a href="#cb119-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb119-7"><a href="#cb119-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb119-8"><a href="#cb119-8" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb119-9"><a href="#cb119-9" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb119-10"><a href="#cb119-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) </span>
<span id="cb119-11"><a href="#cb119-11" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) </span>
<span id="cb119-12"><a href="#cb119-12" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)], <span class="co"># spectral data</span></span>
<span id="cb119-13"><a href="#cb119-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb119-14"><a href="#cb119-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb119-15"><a href="#cb119-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb119-16"><a href="#cb119-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb119-17"><a href="#cb119-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb119-18"><a href="#cb119-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb119-19"><a href="#cb119-19" aria-hidden="true" tabindex="-1"></a>plsda</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Partial Least Squares 

537 samples
  8 predictor
  2 classes: 'D', 'N' 

Pre-processing: centered (8), scaled (8) 
Resampling: Cross-Validated (10 fold, repeated 1 times) 
Summary of sample sizes: 483, 484, 483, 483, 483, 483, ... 
Resampling results across tuning parameters:

  ncomp  ROC        Sens       Spec     
  1      0.8183485  0.8468067  0.5657895
  2      0.8348713  0.8667227  0.6181579
  3      0.8346068  0.8814286  0.6023684
  4      0.8342848  0.8756303  0.6076316
  5      0.8338425  0.8784874  0.6023684
  6      0.8336922  0.8784874  0.6023684
  7      0.8336922  0.8784874  0.6023684

ROC was used to select the optimal model using the largest value.
The final value used for the model was ncomp = 2.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,<span class="at">newdata =</span> dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])</span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 135  40
         N  19  37
                                          
               Accuracy : 0.7446          
                 95% CI : (0.6833, 0.7995)
    No Information Rate : 0.6667          
    P-Value [Acc &gt; NIR] : 0.006419        
                                          
                  Kappa : 0.3833          
                                          
 Mcnemar's Test P-Value : 0.009220        
                                          
            Sensitivity : 0.8766          
            Specificity : 0.4805          
         Pos Pred Value : 0.7714          
         Neg Pred Value : 0.6607          
             Prevalence : 0.6667          
         Detection Rate : 0.5844          
   Detection Prevalence : 0.7576          
      Balanced Accuracy : 0.6786          
                                          
       'Positive' Class : D               
                                          </code></pre>
</div>
</div>
<p>Si tuneamos lambda</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb123-6"><a href="#cb123-6" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb123-7"><a href="#cb123-7" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb123-8"><a href="#cb123-8" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>,<span class="fl">0.1</span>)</span>
<span id="cb123-9"><a href="#cb123-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-10"><a href="#cb123-10" aria-hidden="true" tabindex="-1"></a>  modelo <span class="ot">&lt;-</span> <span class="fu">naiveBayes</span>(dat.train[,<span class="sc">-</span><span class="fu">ncol</span>(datos)],dat.train<span class="sc">$</span>Outcome)</span>
<span id="cb123-11"><a href="#cb123-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-12"><a href="#cb123-12" aria-hidden="true" tabindex="-1"></a>  predicciones <span class="ot">&lt;-</span> <span class="fu">predict</span>(modelo,dat.test[,<span class="sc">-</span><span class="fu">ncol</span>(datos)])</span>
<span id="cb123-13"><a href="#cb123-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb123-14"><a href="#cb123-14" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predicciones,dat.test<span class="sc">$</span>Outcome)<span class="sc">$</span>overall[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Accuracy 
0.7705628 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>datos <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./datos/diabetes.csv"</span>)</span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>datos<span class="sc">$</span>Outcome <span class="ot">&lt;-</span><span class="fu">as.factor</span>(datos<span class="sc">$</span>Outcome)</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>datos[,<span class="dv">1</span><span class="sc">:</span>n1] <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">scale</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)]))</span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(datos<span class="sc">$</span>Outcome) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"D"</span>,<span class="st">"N"</span>)</span>
<span id="cb125-5"><a href="#cb125-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(datos),<span class="at">size =</span> <span class="fu">nrow</span>(datos)<span class="sc">*</span><span class="fl">0.7</span>)</span>
<span id="cb125-6"><a href="#cb125-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-7"><a href="#cb125-7" aria-hidden="true" tabindex="-1"></a>dat.train <span class="ot">&lt;-</span> datos[train,]</span>
<span id="cb125-8"><a href="#cb125-8" aria-hidden="true" tabindex="-1"></a>dat.test <span class="ot">&lt;-</span> datos[<span class="sc">-</span>train,]</span>
<span id="cb125-9"><a href="#cb125-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb125-10"><a href="#cb125-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1001</span>) </span>
<span id="cb125-11"><a href="#cb125-11" aria-hidden="true" tabindex="-1"></a>ctrl<span class="ot">&lt;-</span><span class="fu">trainControl</span>(<span class="at">method=</span><span class="st">"repeatedcv"</span>,<span class="at">number=</span><span class="dv">10</span>,<span class="at">classProbs =</span> <span class="cn">TRUE</span>,<span class="at">summaryFunction =</span> twoClassSummary) </span>
<span id="cb125-12"><a href="#cb125-12" aria-hidden="true" tabindex="-1"></a>plsda<span class="ot">&lt;-</span><span class="fu">train</span>(<span class="at">x=</span>dat.train[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)], <span class="co"># spectral data</span></span>
<span id="cb125-13"><a href="#cb125-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">y=</span>dat.train<span class="sc">$</span>Outcome, <span class="co"># factor vector</span></span>
<span id="cb125-14"><a href="#cb125-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">method=</span><span class="st">"pls"</span>, <span class="co"># pls-da algorithm</span></span>
<span id="cb125-15"><a href="#cb125-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">tuneLength=</span><span class="dv">10</span>, <span class="co"># number of components</span></span>
<span id="cb125-16"><a href="#cb125-16" aria-hidden="true" tabindex="-1"></a>              <span class="at">trControl=</span>ctrl, <span class="co"># ctrl contained cross-validation option</span></span>
<span id="cb125-17"><a href="#cb125-17" aria-hidden="true" tabindex="-1"></a>              <span class="at">preProc=</span><span class="fu">c</span>(<span class="st">"center"</span>,<span class="st">"scale"</span>), <span class="co"># the data are centered and scaled</span></span>
<span id="cb125-18"><a href="#cb125-18" aria-hidden="true" tabindex="-1"></a>              <span class="at">metric=</span><span class="st">"ROC"</span>) <span class="co"># metric is ROC for 2 classes</span></span>
<span id="cb125-19"><a href="#cb125-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb125-20"><a href="#cb125-20" aria-hidden="true" tabindex="-1"></a>prediccion <span class="ot">&lt;-</span> <span class="fu">predict</span>(plsda,dat.test[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">8</span>)])</span>
<span id="cb125-21"><a href="#cb125-21" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(prediccion,dat.test<span class="sc">$</span>Outcome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   D   N
         D 136  42
         N   9  44
                                         
               Accuracy : 0.7792         
                 95% CI : (0.7201, 0.831)
    No Information Rate : 0.6277         
    P-Value [Acc &gt; NIR] : 5.532e-07      
                                         
                  Kappa : 0.4876         
                                         
 Mcnemar's Test P-Value : 7.433e-06      
                                         
            Sensitivity : 0.9379         
            Specificity : 0.5116         
         Pos Pred Value : 0.7640         
         Neg Pred Value : 0.8302         
             Prevalence : 0.6277         
         Detection Rate : 0.5887         
   Detection Prevalence : 0.7706         
      Balanced Accuracy : 0.7248         
                                         
       'Positive' Class : D              
                                         </code></pre>
</div>
</div>
<p>Finalmente podríamos hacer un análisis de la varianza multivariante</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(vegan)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: permute</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>This is vegan 2.6-4</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'vegan'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:caret':

    tolerance</code></pre>
</div>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="fu">adonis2</span>(datos[,<span class="sc">-</span><span class="fu">ncol</span>(datos)] <span class="sc">~</span>datos<span class="sc">$</span>Outcome,<span class="at">method =</span> <span class="st">"euclidean"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Permutation test for adonis under reduced model
Terms added sequentially (first to last)
Permutation: free
Number of permutations: 999

adonis2(formula = datos[, -ncol(datos)] ~ datos$Outcome, method = "euclidean")
               Df SumOfSqs      R2      F Pr(&gt;F)    
datos$Outcome   1    357.8 0.05831 47.434  0.001 ***
Residual      766   5778.2 0.94169                  
Total         767   6136.0 1.00000                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Es decir, como conlusión aunque las variables no pueden detectar la diabetes, siendo variables independientes, si por otro lado las consideramos dependientes de la diabetes.</p>
<p>Es decir, la diabetes es una condición en la que influye en los parámetros, mientras que es menos probable que la diabetes sea la causa de estas alteraciones, con una mejor precisón del 77 por ciento.</p>
<p>Es decir, por un lado tenemos las variables que nos explican solo un 77 porciento de la diabetes, mientras que la condición en sí nos separa más entre la media global.</p>
<p>Se podría investigar más esto. Por ejemplo, se podría hacer una correlación parcial, dada la diabetes, e identificar aquellas variables especificamente relacionadas con esta.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>